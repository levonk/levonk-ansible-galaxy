---
# tasks file for levonk.vibeops.tools - Sublime Text

- name: Install Sublime Text on Windows
  ansible.windows.win_winget:
    name: Sublime Text 4
    id: SublimeHQ.SublimeText.4
    state: present
  when: ansible_os_family == 'Windows'

- name: Install Sublime Text on macOS
  community.general.homebrew_cask:
    name: sublime-text
    state: present
  when: ansible_os_family == 'Darwin'

- name: Install Sublime Text on Debian-based systems
  become: true
  when: ansible_os_family == 'Debian'
  block:
    - name: Ensure dependencies are installed for adding repository
      ansible.builtin.apt:
        name: ["apt-transport-https", "ca-certificates", "curl"]
        state: present

    - name: Add Sublime Text GPG apt Key
      ansible.builtin.get_url:
        url: https://download.sublimetext.com/sublimehq-pub.gpg
        dest: /etc/apt/trusted.gpg.d/sublimehq-pub.gpg
        mode: '0644'
        force: true

    - name: Add Sublime Text Repository
      ansible.builtin.apt_repository:
        repo: "deb https://download.sublimetext.com/ apt/stable/"
        state: present
        filename: sublime-text

    - name: Install Sublime Text
      ansible.builtin.apt:
        name: sublime-text
        state: present
        update_cache: true
